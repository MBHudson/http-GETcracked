#if 0
	MBHudson 2022
#endif

static  char data [] = 
#define      chk2_z	19
#define      chk2	((&data[3]))
	"\176\212\364\222\204\315\315\320\266\212\135\246\306\361\132\144"
	"\275\262\214\037\074\323"
#define      rlax_z	1
#define      rlax	((&data[22]))
	"\304"
#define      inlo_z	3
#define      inlo	((&data[23]))
	"\122\362\201"
#define      pswd_z	256
#define      pswd	((&data[55]))
	"\160\131\115\320\055\133\264\102\214\133\215\326\131\132\161\152"
	"\122\043\224\320\255\211\175\002\343\316\002\342\321\337\202\004"
	"\202\146\200\004\163\162\051\073\353\162\230\312\305\272\054\233"
	"\202\332\325\322\311\357\254\332\323\270\255\002\227\057\007\032"
	"\226\207\036\011\372\107\105\345\272\335\260\177\227\334\032\032"
	"\266\360\354\200\340\231\133\263\121\010\266\351\070\275\003\316"
	"\105\042\330\077\152\035\045\045\372\325\244\222\262\277\254\150"
	"\260\231\351\220\063\104\104\204\115\372\156\205\270\161\124\375"
	"\224\055\074\377\112\141\044\105\067\310\327\351\210\203\122\071"
	"\035\073\312\120\177\016\325\314\011\103\122\301\265\247\277\111"
	"\324\374\110\037\136\155\144\225\066\073\177\276\277\321\367\334"
	"\015\302\055\215\321\002\132\332\105\255\234\372\124\134\104\051"
	"\130\215\110\266\372\254\113\060\350\312\357\247\234\347\204\252"
	"\251\261\067\172\263\221\125\371\077\362\364\223\116\070\274\246"
	"\306\005\134\301\261\250\361\231\163\341\101\020\310\305\272\162"
	"\167\362\354\052\204\102\044\303\064\030\126\203\121\023\051\027"
	"\030\206\330\312\057\312\144\242\253\245\263\163\153\155\346\342"
	"\137\323\015\343\025\061\246\112\111\375\315\232\021\165\115\102"
	"\317\233\022\374\366\307\077\203\042\314\132\173\047\313\346\171"
	"\356\173\111\234\004\307\236\350"
#define      chk1_z	22
#define      chk1	((&data[341]))
	"\146\026\030\251\177\243\134\243\033\244\320\221\232\300\055\175"
	"\057\155\340\317\057\056\361\001\250\251\346\264\273"
#define      tst2_z	19
#define      tst2	((&data[370]))
	"\043\056\245\225\056\153\003\311\011\276\040\017\136\377\173\051"
	"\111\123\160\357\104\126\357\210"
#define      msg1_z	65
#define      msg1	((&data[392]))
	"\010\047\215\302\130\215\073\020\252\243\136\223\233\203\014\230"
	"\246\202\234\105\306\074\344\203\276\033\042\343\163\172\206\363"
	"\213\350\103\136\211\374\233\337\325\154\037\131\221\274\130\074"
	"\124\217\306\331\326\040\100\011\200\111\230\152\052\252\111\025"
	"\375\343\220\102\203\332\336"
#define      tst1_z	22
#define      tst1	((&data[465]))
	"\160\066\035\167\266\350\002\052\151\332\274\152\001\110\132\250"
	"\346\342\137\115\242\272\175\054\370\072\235"
#define      shll_z	10
#define      shll	((&data[489]))
	"\221\322\132\071\330\335\107\251\206\034"
#define      date_z	1
#define      date	((&data[499]))
	"\347"
#define      xecc_z	15
#define      xecc	((&data[502]))
	"\041\341\274\075\142\163\351\162\214\315\271\065\112\336\005\301"
	"\117\053\021"
#define      lsto_z	1
#define      lsto	((&data[519]))
	"\367"
#define      opts_z	1
#define      opts	((&data[520]))
	"\175"
#define      msg2_z	19
#define      msg2	((&data[525]))
	"\336\140\064\133\000\355\120\123\235\274\312\177\012\244\034\006"
	"\334\006\172\325\246\042\317\320\153"
#define      text_z	6667
#define      text	((&data[619]))
	"\255\136\117\310\146\122\306\030\330\350\372\003\371\144\120\042"
	"\042\246\332\042\176\155\001\337\241\135\257\014\326\273\025\204"
	"\031\145\114\200\267\023\230\217\373\223\223\365\367\343\027\032"
	"\211\362\074\010\137\076\347\001\233\227\015\161\122\043\366\154"
	"\210\102\354\077\126\205\317\122\030\160\111\153\245\057\230\131"
	"\247\166\261\074\176\262\254\164\212\200\207\126\227\117\316\123"
	"\262\174\346\142\124\016\260\150\274\102\350\117\054\303\312\155"
	"\017\374\136\151\030\216\354\334\147\201\105\224\163\130\174\067"
	"\055\343\205\033\344\313\307\124\364\246\373\275\123\214\261\155"
	"\121\074\170\333\265\232\211\144\311\263\312\166\264\351\263\355"
	"\227\140\373\365\041\073\132\041\212\112\043\331\347\041\153\032"
	"\237\106\133\346\237\125\077\325\341\322\100\216\037\345\347\031"
	"\014\326\275\202\016\056\211\353\254\010\263\147\103\114\235\165"
	"\047\063\322\322\176\104\166\157\203\034\173\043\304\045\347\230"
	"\303\207\001\044\043\032\325\351\346\204\155\041\133\252\126\171"
	"\051\116\171\342\102\137\104\205\245\275\264\035\277\150\322\002"
	"\376\067\373\341\112\312\361\376\136\152\120\126\350\127\153\321"
	"\047\052\143\362\277\023\377\060\167\156\114\053\150\272\246\146"
	"\044\021\071\017\354\251\003\344\053\343\152\264\320\113\112\055"
	"\330\274\243\314\067\341\036\125\032\206\115\031\132\157\004\370"
	"\207\327\245\312\062\140\271\347\266\361\217\204\214\033\142\277"
	"\251\157\204\012\216\102\275\311\145\255\003\377\150\031\014\062"
	"\371\077\226\362\176\361\102\355\132\105\023\076\176\266\175\015"
	"\110\243\110\306\045\007\370\057\225\165\071\313\175\046\374\331"
	"\034\243\147\020\245\311\351\336\026\073\133\053\135\100\316\222"
	"\235\170\053\102\236\224\061\321\376\100\262\104\307\224\146\061"
	"\357\335\274\271\157\224\002\175\310\204\073\013\136\025\044\121"
	"\057\047\256\332\215\364\362\347\041\303\032\274\101\157\020\202"
	"\144\206\171\356\373\245\147\040\042\367\277\175\256\300\026\026"
	"\145\222\300\201\247\352\140\350\053\236\245\362\120\243\061\103"
	"\247\131\230\076\161\102\146\205\243\276\352\303\057\141\045\164"
	"\254\172\054\014\075\157\321\214\366\351\161\373\062\275\220\143"
	"\173\261\230\074\175\174\233\245\060\355\027\061\070\356\312\055"
	"\322\205\005\333\326\272\261\035\362\103\231\064\061\263\042\047"
	"\310\125\111\306\315\352\325\045\015\360\062\343\372\106\106\142"
	"\223\066\214\350\145\116\274\205\026\317\001\253\225\074\052\161"
	"\000\350\356\106\170\246\106\053\021\253\104\001\315\122\221\224"
	"\320\013\346\171\306\345\077\211\127\257\162\006\143\334\161\103"
	"\373\061\224\131\226\264\244\216\207\072\060\374\170\152\372\024"
	"\024\035\153\034\055\244\260\147\341\143\240\073\107\154\343\272"
	"\142\326\230\324\146\076\265\154\377\066\250\204\156\376\041\125"
	"\101\032\045\127\264\316\052\213\110\223\344\037\201\016\011\170"
	"\020\013\002\013\376\334\212\065\246\002\325\263\235\262\240\076"
	"\355\252\212\121\001\211\047\336\053\173\055\161\315\030\343\135"
	"\365\346\035\170\024\375\311\344\336\154\155\133\223\263\134\030"
	"\311\147\030\327\256\150\103\206\314\056\024\260\134\034\142\356"
	"\005\024\203\157\356\144\324\375\011\204\122\237\255\122\321\126"
	"\203\055\075\365\127\242\376\237\120\267\362\344\030\106\320\333"
	"\247\205\056\006\247\317\023\262\222\243\262\160\131\141\214\211"
	"\102\007\015\120\305\242\363\073\311\131\346\302\011\020\373\043"
	"\343\070\344\066\221\316\256\164\356\156\152\276\006\217\362\066"
	"\160\123\245\341\147\223\321\174\355\336\316\172\264\170\153\316"
	"\145\027\177\247\172\042\041\274\166\360\331\362\353\202\065\040"
	"\137\103\174\244\366\153\242\203\356\304\226\267\246\175\353\225"
	"\213\102\021\007\123\073\171\153\131\070\167\050\021\152\207\221"
	"\147\171\265\240\264\153\210\000\060\261\263\242\312\247\005\341"
	"\004\127\271\017\134\007\062\136\315\315\204\045\274\006\163\247"
	"\217\155\134\120\213\337\002\311\370\233\173\111\127\163\030\211"
	"\317\166\035\147\340\310\331\303\276\116\325\010\002\012\161\264"
	"\126\045\064\133\256\336\016\372\055\274\222\211\105\100\260\060"
	"\062\044\043\342\301\356\273\367\377\163\076\040\061\127\264\226"
	"\104\003\342\313\265\043\170\375\247\265\043\025\301\375\213\123"
	"\330\127\107\274\240\024\240\133\034\276\122\357\070\050\103\277"
	"\223\051\251\325\015\135\301\102\155\212\335\224\275\165\235\243"
	"\203\141\363\341\040\310\226\124\100\241\372\107\212\000\301\236"
	"\312\265\064\031\052\122\247\352\124\070\161\041\050\242\020\371"
	"\240\252\366\116\007\166\135\013\342\333\013\350\001\172\005\201"
	"\370\336\161\376\140\272\257\335\355\144\075\111\371\060\251\311"
	"\167\374\277\232\177\330\327\026\227\033\374\256\043\055\231\003"
	"\376\362\274\035\210\375\010\316\264\256\021\152\015\024\004\173"
	"\271\024\264\232\246\333\126\345\237\226\266\367\212\360\313\363"
	"\170\016\156\176\226\142\163\303\341\077\166\073\374\272\213\264"
	"\311\006\052\072\173\241\075\340\315\300\121\142\372\361\154\130"
	"\126\201\272\017\112\234\036\367\000\312\136\272\041\301\145\063"
	"\122\041\263\007\162\114\264\204\157\102\142\217\363\001\056\001"
	"\015\124\134\146\210\105\146\020\371\354\075\246\040\156\203\056"
	"\037\313\354\242\101\251\241\262\312\072\207\142\363\004\052\257"
	"\211\310\141\207\124\053\011\072\273\011\216\040\167\162\250\126"
	"\303\203\263\336\130\241\333\073\127\046\045\155\345\003\313\362"
	"\022\300\134\245\316\156\206\256\167\236\240\154\057\241\052\131"
	"\322\133\032\235\357\073\050\073\152\002\371\143\367\006\205\267"
	"\154\010\101\136\071\344\250\143\341\002\125\114\233\131\106\361"
	"\003\114\215\016\324\161\011\030\067\137\101\044\242\132\375\071"
	"\264\071\350\154\035\022\267\044\023\203\142\014\135\067\360\004"
	"\152\056\105\377\224\330\265\243\253\233\304\116\035\243\247\375"
	"\060\010\351\315\140\156\157\077\247\245\373\005\254\257\020\200"
	"\075\051\275\374\154\301\005\240\313\376\012\107\044\010\205\123"
	"\265\355\143\134\254\356\373\121\301\124\000\001\361\201\237\317"
	"\006\132\035\321\253\134\151\220\347\306\104\127\005\026\012\372"
	"\225\135\326\216\231\366\201\104\265\266\203\277\050\004\103\304"
	"\163\113\314\376\275\240\003\263\251\231\162\013\107\354\251\241"
	"\176\053\062\304\206\207\200\253\320\206\106\307\157\063\130\032"
	"\101\102\317\375\347\026\347\001\045\037\135\046\330\061\324\262"
	"\165\076\246\247\066\336\276\325\067\157\222\000\141\114\001\177"
	"\120\021\244\333\070\137\301\322\071\036\146\256\277\264\101\017"
	"\032\111\016\200\066\176\212\372\361\130\133\077\071\221\311\102"
	"\211\235\214\270\324\301\126\305\257\223\316\363\014\330\347\205"
	"\221\171\153\074\056\354\137\104\176\101\035\153\016\111\114\236"
	"\317\040\324\042\024\345\264\201\262\352\371\062\077\023\231\173"
	"\301\160\136\177\027\241\353\062\056\165\016\322\152\101\114\142"
	"\331\177\221\234\052\344\331\007\155\347\152\157\223\330\073\314"
	"\242\225\324\303\263\207\014\154\033\353\246\177\212\371\346\067"
	"\066\155\014\244\260\035\113\337\052\005\332\014\066\373\134\162"
	"\031\054\371\151\067\136\035\107\120\325\031\015\065\205\231\005"
	"\117\365\342\224\052\243\252\021\205\054\052\060\357\257\170\342"
	"\005\041\347\035\240\212\055\162\152\132\050\213\111\137\270\330"
	"\373\021\016\315\121\064\260\373\340\341\214\072\377\377\163\360"
	"\064\020\021\065\362\004\345\342\206\055\030\016\305\200\034\352"
	"\365\066\137\176\256\222\316\361\307\073\176\061\323\153\156\351"
	"\213\275\361\326\211\350\124\374\041\300\160\171\376\302\223\072"
	"\320\030\324\240\325\045\326\115\341\244\055\273\157\104\363\303"
	"\313\125\165\273\374\206\241\244\334\333\215\061\262\330\321\031"
	"\074\072\135\046\157\165\012\017\003\246\167\314\025\200\370\112"
	"\066\002\233\100\335\332\236\025\341\213\370\146\102\246\121\020"
	"\243\152\376\105\151\170\014\005\160\277\156\357\165\263\144\333"
	"\163\156\072\106\154\301\147\144\346\205\303\263\165\117\107\275"
	"\267\344\331\327\172\031\111\200\116\051\371\030\046\051\064\203"
	"\136\060\154\172\327\353\123\361\320\344\133\253\303\075\223\246"
	"\362\301\346\044\226\326\273\170\123\111\145\205\351\114\222\026"
	"\336\353\334\210\176\263\147\166\076\176\230\207\027\217\142\165"
	"\365\262\330\170\002\054\235\224\075\137\164\052\376\156\036\263"
	"\012\017\376\012\051\210\017\346\131\010\235\344\263\347\275\105"
	"\063\223\242\060\364\326\120\335\062\166\177\131\242\234\336\002"
	"\007\112\162\213\175\014\225\067\176\302\336\377\173\105\222\263"
	"\031\307\136\205\223\336\357\353\131\150\372\113\021\356\105\375"
	"\261\065\213\212\272\206\075\262\237\117\145\077\232\057\066\175"
	"\221\341\251\031\044\360\072\137\151\127\163\206\011\071\201\233"
	"\117\155\161\270\353\347\017\342\040\254\203\001\051\252\267\203"
	"\166\300\372\071\257\015\251\157\317\374\367\312\167\134\037\072"
	"\113\045\071\036\335\116\244\005\056\016\310\277\053\134\236\357"
	"\261\033\221\076\027\001\305\070\360\160\354\220\365\033\055\166"
	"\057\346\311\003\155\272\003\150\122\137\211\315\217\155\265\327"
	"\355\007\363\206\117\237\036\270\115\203\272\231\307\070\336\123"
	"\312\325\346\157\202\352\042\324\057\111\331\177\240\223\104\235"
	"\252\175\263\342\251\251\020\217\155\040\272\113\244\030\361\135"
	"\072\240\250\130\163\335\264\160\307\362\376\203\360\103\303\156"
	"\244\230\002\067\033\265\045\041\102\107\126\111\220\023\137\372"
	"\362\051\134\011\177\251\247\062\347\136\164\323\223\020\077\154"
	"\204\044\340\251\053\072\053\113\170\167\115\376\062\326\050\236"
	"\336\266\120\205\006\331\253\114\302\053\107\332\331\350\345\350"
	"\272\256\305\365\245\130\020\351\173\121\324\102\233\126\150\137"
	"\252\272\273\203\265\024\026\212\302\237\267\270\321\017\206\135"
	"\156\172\114\001\256\052\322\037\113\216\160\242\334\344\356\173"
	"\126\324\141\331\332\062\363\056\314\345\247\245\366\313\306\236"
	"\250\340\210\164\171\347\264\223\317\034\052\200\314\225\055\144"
	"\165\271\264\107\306\374\353\146\044\333\107\263\142\255\365\150"
	"\271\215\246\230\364\377\123\256\357\031\142\163\327\044\142\234"
	"\074\060\073\225\316\367\171\107\377\102\271\055\105\170\257\040"
	"\270\220\037\155\273\016\002\015\077\100\037\374\260\153\361\060"
	"\275\253\011\270\032\226\217\170\146\106\362\111\101\064\016\136"
	"\351\200\365\166\353\161\226\125\132\151\347\266\353\354\245\037"
	"\014\144\304\236\211\205\255\022\251\246\332\340\311\354\107\350"
	"\065\032\221\271\134\264\231\345\244\312\363\277\240\233\327\145"
	"\067\014\207\377\344\276\331\210\020\166\236\305\114\202\102\024"
	"\246\076\331\340\171\235\155\061\101\342\226\033\217\265\074\034"
	"\151\130\351\106\062\365\377\330\010\205\202\244\361\203\307\156"
	"\247\322\035\206\064\225\227\301\136\016\134\237\200\026\162\321"
	"\024\242\070\024\231\324\214\037\222\266\312\037\326\255\150\076"
	"\034\364\326\015\236\070\325\255\241\370\245\203\340\212\061\226"
	"\322\165\106\116\214\156\133\014\234\256\166\001\206\066\220\160"
	"\102\036\342\250\250\054\110\344\143\377\340\006\005\125\375\145"
	"\303\121\215\266\364\100\160\010\005\330\337\113\324\100\113\055"
	"\213\353\221\063\231\122\137\256\214\214\264\243\020\020\072\365"
	"\036\174\247\050\026\166\160\336\355\264\364\132\164\361\377\132"
	"\263\227\103\114\311\367\035\274\061\165\306\255\131\177\003\263"
	"\267\274\315\257\150\347\160\103\242\341\006\176\031\262\007\171"
	"\056\150\037\362\141\065\123\300\127\056\357\246\141\033\110\353"
	"\364\126\175\262\066\014\312\164\004\270\020\060\333\047\150\342"
	"\001\265\221\107\351\334\346\142\162\006\347\204\045\103\240\204"
	"\277\352\151\120\000\154\361\256\321\276\246\177\217\074\224\126"
	"\217\202\212\225\056\255\255\340\376\163\242\077\072\357\112\333"
	"\222\147\360\373\333\242\154\336\375\113\346\176\311\123\166\167"
	"\204\072\101\142\116\313\335\364\251\000\025\226\025\102\242\374"
	"\340\342\250\253\222\001\304\161\253\074\114\020\175\304\302\342"
	"\161\265\252\070\332\176\271\212\072\117\007\204\005\003\131\034"
	"\234\067\004\301\040\222\247\266\207\357\015\235\365\302\302\244"
	"\076\345\362\055\302\224\300\377\113\100\123\361\210\357\167\261"
	"\127\243\233\113\264\330\233\202\065\312\302\046\357\046\004\050"
	"\322\325\075\121\067\222\232\247\311\130\147\101\317\217\226\112"
	"\142\234\337\351\046\012\110\122\125\334\163\226\006\235\307\301"
	"\055\267\304\166\334\057\133\171\355\251\261\360\272\237\304\056"
	"\166\236\341\017\072\347\350\202\234\066\242\127\130\036\244\322"
	"\315\375\060\216\312\170\203\255\325\000\341\164\106\144\341\372"
	"\132\321\271\276\333\346\271\370\173\161\372\335\223\123\361\046"
	"\253\253\024\242\013\246\367\243\261\135\154\213\230\300\135\275"
	"\023\027\104\054\007\340\057\243\244\063\150\070\317\047\337\331"
	"\073\244\067\307\200\115\317\335\010\210\063\210\355\175\171\134"
	"\022\377\265\216\250\005\301\134\127\034\371\165\111\220\343\346"
	"\013\133\337\246\121\275\316\205\046\155\342\026\326\214\051\242"
	"\171\360\242\034\370\113\340\144\346\077\011\216\304\340\360\355"
	"\134\307\214\062\373\033\221\004\242\033\154\247\156\062\221\367"
	"\332\073\110\311\244\044\277\244\356\127\245\350\114\050\376\311"
	"\121\126\372\113\004\375\034\030\201\053\134\074\263\320\026\004"
	"\361\110\256\315\116\036\160\334\246\036\033\300\360\002\336\127"
	"\237\354\347\132\052\037\140\377\060\371\165\243\324\317\111\310"
	"\054\027\333\022\245\014\073\315\233\123\323\205\215\312\043\066"
	"\122\045\050\256\071\226\056\367\272\335\041\052\034\223\152\124"
	"\240\333\213\004\015\175\071\267\336\100\330\317\112\223\073\111"
	"\045\271\240\130\250\043\103\163\377\354\170\142\333\211\166\256"
	"\251\015\236\132\262\175\044\025\053\121\345\110\214\002\320\304"
	"\251\104\033\314\220\274\153\027\354\326\352\356\242\201\274\061"
	"\145\213\324\236\313\231\304\251\323\357\004\015\032\241\123\337"
	"\175\206\117\064\211\106\365\055\054\102\243\375\373\064\153\322"
	"\101\026\370\223\323\154\145\230\020\136\170\154\076\032\256\143"
	"\074\367\102\027\171\253\061\071\164\201\261\041\162\332\174\207"
	"\101\212\305\356\241\117\037\274\163\016\300\033\010\356\055\222"
	"\075\171\252\016\321\310\123\156\265\077\162\327\251\355\275\003"
	"\047\076\252\141\124\117\030\133\343\233\036\113\101\206\171\241"
	"\071\332\322\343\051\075\356\034\355\050\232\154\216\012\114\232"
	"\004\152\166\134\202\370\155\042\041\010\113\304\133\044\347\235"
	"\257\374\352\334\054\207\073\224\022\105\322\257\003\102\100\200"
	"\054\247\041\141\335\205\337\064\347\364\271\161\165\214\357\173"
	"\157\353\050\324\074\141\315\370\301\363\107\374\322\315\211\137"
	"\224\154\100\305\023\334\211\324\016\252\352\244\156\170\363\003"
	"\274\263\366\212\143\265\320\144\157\371\356\006\022\107\147\040"
	"\207\353\052\375\343\243\151\151\236\201\233\336\011\047\114\203"
	"\010\173\072\041\220\246\224\347\112\124\231\262\370\013\233\246"
	"\206\275\257\144\104\233\366\002\336\067\163\021\265\250\314\135"
	"\312\064\027\163\037\131\213\136\207\212\117\003\102\155\322\120"
	"\203\011\347\040\135\135\066\050\007\353\247\020\231\177\243\043"
	"\157\123\122\152\243\136\353\341\204\337\210\017\377\153\270\250"
	"\167\267\311\335\020\031\070\024\076\312\033\252\272\363\314\224"
	"\172\031\264\252\002\005\017\135\011\114\127\076\063\266\206\021"
	"\056\221\265\114\130\357\240\114\112\370\076\201\163\015\246\147"
	"\231\211\146\162\202\317\317\237\225\244\112\210\226\061\330\250"
	"\334\326\031\150\123\263\225\136\206\027\345\342\000\354\217\107"
	"\174\266\124\016\107\051\171\276\001\063\306\046\304\152\352\274"
	"\163\120\017\121\131\136\307\255\232\376\076\300\225\306\104\050"
	"\015\331\216\270\015\361\125\373\164\136\041\265\325\354\165\000"
	"\032\116\141\317\047\100\204\256\137\323\024\054\356\014\051\111"
	"\170\325\314\165\216\334\017\053\303\125\316\353\346\061\071\067"
	"\045\163\350\154\126\213\241\070\007\351\123\250\262\223\124\167"
	"\262\032\166\067\305\235\037\314\220\027\341\242\060\311\164\350"
	"\263\236\210\067\162\373\316\311\226\004\371\073\025\353\010\377"
	"\104\117\334\241\217\036\335\215\337\247\037\330\153\331\374\311"
	"\013\252\262\362\275\114\037\072\340\115\237\141\140\004\305\257"
	"\343\253\205\166\072\302\047\250\052\002\121\366\147\010\274\273"
	"\023\334\061\062\322\045\010\132\251\015\207\031\347\231\125\300"
	"\041\167\243\043\362\301\330\206\141\375\006\336\266\042\200\355"
	"\075\256\011\133\366\004\366\020\332\111\011\257\144\203\350\130"
	"\126\036\365\166\252\256\370\112\366\174\160\337\364\250\322\212"
	"\155\076\170\077\375\150\064\370\001\370\243\122\347\353\345\024"
	"\322\112\155\252\205\202\151\336\120\357\233\103\221\251\114\334"
	"\147\127\173\270\375\250\255\107\355\044\347\355\256\375\013\006"
	"\303\251\342\177\170\337\335\240\203\115\337\342\237\140\256\320"
	"\115\137\377\103\175\066\161\350\204\037\163\311\045\075\135\275"
	"\255\257\122\171\323\054\037\306\216\065\146\171\162\347\152\043"
	"\150\072\332\341\003\100\040\316\356\067\013\210\035\147\360\366"
	"\264\103\315\021\243\165\072\263\234\357\071\054\115\104\372\332"
	"\220\140\276\233\242\053\152\114\107\266\365\325\145\317\026\377"
	"\070\267\075\305\234\065\007\123\252\176\136\303\174\230\233\144"
	"\042\065\300\163\121\066\324\133\312\315\326\104\100\222\032\262"
	"\070\213\063\301\066\062\201\366\136\226\265\100\156\025\340\252"
	"\042\345\044\311\335\323\045\033\142\234\217\123\334\173\232\165"
	"\161\232\226\045\005\055\245\146\154\232\171\015\035\043\110\220"
	"\335\357\231\323\355\070\313\227\375\032\252\005\367\263\134\273"
	"\253\006\366\375\074\363\327\310\247\055\072\274\214\004\351\102"
	"\111\152\215\066\246\240\201\076\332\314\070\352\020\212\272\351"
	"\201\247\050\102\162\076\137\377\353\207\132\262\377\340\235\314"
	"\177\151\254\211\030\102\243\020\366\272\300\031\163\336\314\051"
	"\025\211\216\207\142\027\264\125\065\260\155\121\020\066\265\237"
	"\362\005\270\363\050\071\312\311\260\322\224\305\160\110\161\037"
	"\155\273\024\030\007\027\145\071\062\071\225\315\140\147\366\023"
	"\221\316\264\340\265\205\172\172\310\124\354\372\352\321\306\162"
	"\203\224\346\354\336\306\374\155\110\310\121\076\277\327\155\003"
	"\307\371\131\002\041\261\121\004\045\301\366\204\226\126\245\351"
	"\045\242\350\022\317\115\134\003\112\365\111\011\250\073\121\331"
	"\024\116\363\110\053\301\225\113\176\246\065\016\007\246\104\072"
	"\363\367\047\334\000\325\074\206\215\275\207\067\122\006\017\137"
	"\200\115\056\223\261\225\201\120\177\102\000\142\161\243\330\136"
	"\165\110\306\156\163\136\143\216\137\327\102\075\233\317\314\256"
	"\362\325\101\300\072\207\253\067\206\060\216\214\104\226\252\156"
	"\362\061\206\045\246\266\237\254\072\017\267\302\271\220\017\351"
	"\273\151\307\105\217\366\140\264\203\345\226\227\232\336\164\115"
	"\333\365\237\016\036\146\011\265\210\016\144\213\142\274\220\150"
	"\366\373\111\076\276\257\306\043\207\214\110\056\224\252\176\360"
	"\257\202\326\334\040\301\036\130\201\007\131\041\100\144\125\002"
	"\024\202\343\375\266\203\027\327\245\116\217\176\376\363\323\034"
	"\126\024\337\203\230\367\055\311\061\014\204\163\230\213\002\163"
	"\361\365\056\147\303\247\031\317\067\140\374\217\272\105\334\037"
	"\351\360\032\117\055\012\231\320\066\001\341\171\354\101\032\262"
	"\013\374\174\242\304\374\350\065\311\364\110\043\266\340\056\304"
	"\222\274\241\327\303\101\234\245\205\220\015\231\330\144\057\153"
	"\230\231\061\316\045\225\175\146\377\245\124\045\050\114\017\157"
	"\101\240\353\345\043\175\372\020\126\275\002\053\314\202\213\143"
	"\043\170\044\126\153\015\134\333\103\145\070\064\353\327\204\037"
	"\034\076\275\322\050\200\376\376\052\220\137\011\235\375\137\275"
	"\071\257\372\026\141\112\177\135\012\017\071\036\353\255\054\006"
	"\363\273\301\226\173\321\111\335\177\247\233\267\327\041\102\066"
	"\317\116\115\371\054\220\037\226\245\126\336\204\145\307\044\053"
	"\261\015\331\162\167\004\260\162\256\346\307\017\064\377\071\114"
	"\221\037\375\130\106\326\056\345\221\223\046\365\036\137\062\216"
	"\102\017\203\254\370\304\253\240\244\337\211\136\043\064\352\223"
	"\326\170\340\305\150\221\075\005\273\073\112\041\214\102\112\000"
	"\002\034\030\364\352\343\134\053\355\123\056\322\124\065\335\044"
	"\140\373\140\130\327\176\003\135\050\164\346\131\173\141\343\225"
	"\262\025\356\326\135\147\355\163\356\304\244\353\327\061\021\340"
	"\355\100\046\245\061\053\106\231\217\051\211\237\016\113\311\007"
	"\300\167\231\126\042\335\010\365\234\340\017\376\126\225\014\042"
	"\362\217\330\342\103\266\074\136\314\315\056\116\162\363\323\201"
	"\011\030\200\322\003\064\122\115\106\122\146\343\257\272\264\146"
	"\134\102\305\242\337\055\272\115\016\307\042\314\301\027\067\005"
	"\202\034\160\137\223\144\041\221\063\105\046\221\177\064\355\276"
	"\011\245\104\176\145\027\254\371\050\140\037\130\261\245\132\276"
	"\376\203\123\046\343\306\006\226\330\001\265\247\057\015\061\365"
	"\316\360\375\141\064\036\366\150\053\036\155\204\067\275\222\100"
	"\217\357\253\302\002\053\322\130\326\233\014\013\225\365\330\263"
	"\371\123\150\243\353\310\364\106\257\302\360\173\240\323\050\346"
	"\266\030\064\047\010\264\162\015\330\250\330\072\321\147\341\250"
	"\047\024\303\253\342\155\370\133\364\274\366\275\364\312\121\324"
	"\266\036\252\025\113\053\356\213\127\126\060\242\015\101\004\262"
	"\010\004\146\055\163\115\155\007\152\267\166\000\354\113\104\056"
	"\076\262\267\061\307\163\201\251\011\326\004\225\313\177\211\040"
	"\177\054\234\271\031\103\321\057\144\014\346\044\175\012\050\176"
	"\363\102\137\255\233\223\273\240\002\330\337\153\227\332\146\000"
	"\220\377\323\342\112\104\355\251\125\042\104\264\164\047\361\367"
	"\154\056\273\162\337\344\360\023\354\115\231\342\247\224\304\211"
	"\247\011\225\334\211\133\136\204\351\235\325\155\237\145\136\221"
	"\313\134\361\064\312\367\136\314\245\246\233\223\176\135\337\054"
	"\242\200\142\300\372\367\312\034\312\063\237\114\116\273\017\355"
	"\103\035\122\031\304\077\214\061\151\013\232\344\270\062\356\113"
	"\306\220\004\266\355\023\014\334\055\177\341\017\367\034\370\256"
	"\200\145\317\042\246\274\155\070\322\243\374\053\173\220\240\023"
	"\163\112\153\160\245\122\053\243\172\317\131\121\117\253\265\116"
	"\232\214\220\036\225\170\130\120\203\320\117\366\013\302\272\122"
	"\363\136\205\223\277\030\043\032\160\275\067\120\370\047\113\037"
	"\207\301\221\003\153\267\134\047\131\043\161\375\054\027\114\327"
	"\103\056\202\057\141\323\305\112\005\055\242\243\250\071\050\077"
	"\125\306\304\334\045\074\130\156\315\265\315\126\115\313\066\052"
	"\245\156\360\273\317\273\213\147\363\265\024\013\137\307\200\233"
	"\014\074\117\113\303\045\207\304\231\253\334\022\035\074\041\150"
	"\063\343\352\350\070\157\011\260\150\054\166\274\361\325\143\257"
	"\325\065\217\274\161\256\004\215\267\143\044\310\360\073\202\370"
	"\122\112\222\062\145\155\060\243\340\175\332\215\075\110\001\241"
	"\326\347\226\213\172\263\105\152\000\133\252\321\073\254\115\004"
	"\135\004\323\362\023\364\233\067\274\237\253\311\065\203\263\265"
	"\144\225\017\257\361\350\061\074\124\221\273\223\215\311\307\210"
	"\160\131\374\340\241\237\217\101\123\062\160\150\100\054\261\215"
	"\220\273\035\372\052\122\340\210\236\206\073\054\235\163\030\105"
	"\071\011\322\253\352\072\302\333\371\103\054\014\152\114\347\106"
	"\172\017\064\236\264\304\206\323\316\253\274\362\005\274\300\132"
	"\171\331\115\231\111\036\157\145\107\243\317\345\374\163\150\246"
	"\345\066\312\123\124\133\260\343\257\354\165\262\065\110\347\337"
	"\234\036\224\134\061\165\155\220\021\322\336\357\256\265\075\203"
	"\221\211\162\137\235\046\144\005\241\321\143\214\262\205\241\220"
	"\073\135\066\212\251\260\127\331\154\056\135\312\121\245\361\206"
	"\263\060\070\323\025\220\346\074\242\316\017\041\233\351\145\355"
	"\374\043\042\107\174\150\013\176\251\250\031\105\164\146\203\264"
	"\037\267\054\044\331\126\162\111\274\205\140\312\065\364\015\123"
	"\047\326\132\104\304\256\172\233\041\376\337\350\335\272\376\255"
	"\117\164\205\111\112\323\157\377\213\251\161\041\234\176\331\202"
	"\265\010\314\074\046\027\004\106\223\251\155\331\162\112\222\012"
	"\371\202\166\016\166\065\363\000\162\076\364\143\307\213\122\335"
	"\352\336\237\351\365\025\222\163\273\154\061\112\201\055\100\166"
	"\251\352\130\310\267\367\025\212\304\232\123\373\217\271\124\305"
	"\005\137\071\017\030\140\011\202\377\111\107\162\072\267\236\315"
	"\127\270\074\311\321\033\245\161\123\233\241\377\312\202\024\023"
	"\215\051\176\232\262\345\345\344\165\043\016\213\025\037\302\301"
	"\032\204\030\214\007\043\224\273\130\136\252\131\275\140\243\061"
	"\336\332\251\343\332\373\005\331\326\343\106\114\110\227\040\207"
	"\017\260\101\357\223\045\135\244\163\150\131\331\330\221\265\065"
	"\306\204\317\053\323\113\125\340\202\012\017\157\131\335\024\177"
	"\030\242\132\143\214\121\057\314\044\305\200\240\225\012\361\147"
	"\127\275\107\214\240\012\203\351\010\144\155\310\334\313\270\325"
	"\256\002\243\263\253\326\174\146\240\355\226\025\351\324\165\021"
	"\350\103\250\133\333\067\144\141\330\164\374\274\166\105\347\105"
	"\354\237\120\275\211\113\003\103\132\105\137\033\314\337\120\247"
	"\342\240\173\123\052\254\170\034\363\263\226\271\341\345\101\313"
	"\265\012\044\155\343\243\340\204\016\027\307\265\125\006\017\055"
	"\166\070\372\162\321\266\152\210\276\304\357\273\165\013\340\032"
	"\260\060\170\136\021\251\372\212\367\305\241\223\110\372\157\257"
	"\362\146\174\057\147\345\032\365\131\231\314\127\110\231\114\360"
	"\376\126\161\052\143\217\370\114\040\107\213\130\022\152\122\153"
	"\152\143\062\250\210\370\232\117\116\117\007\171\215\033\227\325"
	"\101\007\306\006\071\245\125\322\065\164\127\054\061\335\065\113"
	"\162\375\230\333\233\024\275\111\033\033\127\115\377\234\073\341"
	"\267\302\100\324\353\115\005\001\236\155\005\041\276\341\040\066"
	"\301\016\007\364\175\146\045\170\304\313\064\264\063\133\233\164"
	"\221\120\301\267\004\247\262\350\320\125\152\050\345\044\156\336"
	"\305\273\204\351\042\313\066\034\027\146\140\230\237\070\031\336"
	"\232\364\307\301\254\171\257\351\132\221\376\322\320\310\207\374"
	"\146\245\102\060\121\214\066\375\133\354\205\222\302\071\251\103"
	"\047\220\147\350\117\001\354\234\130\226\022\071\115\157\251\112"
	"\104\236\021\262\376\221\002\035\171\337\201\337\002\227\232\203"
	"\173\363\152\363\352\357\221\004\121\014\323\370\101\234\326\004"
	"\301\055\233\374\254\165\220\116\153\020\255\356\104\144\304\033"
	"\277\356\173\127\127\361\075\157\242\234\362\147\210\322\252\007"
	"\034\027\070\016\160\101\226\276\273\346\371\204\161\220\203\234"
	"\310\136\015\132\065\041\267\066\015\364\375\066\331\040\103\235"
	"\073\163\041\236\163\131\114\130\032\261\126\215\324\312\037\135"
	"\055\326\343\173\371\252\062\306\251\352\175\304\062\257\200\061"
	"\014\333\246\026\150\255\030\007\001\016\353\026\325\032\157\352"
	"\025\356\066\002\034\361\303\171\201\273\140\276\050\234\053\150"
	"\015\043\217\221\271\342\331\067\024\077\101\315\365\017\344\375"
	"\313\016\264\047\365\306\231\301\366\325\351\000\205\302\325\152"
	"\043\030\357\365\126\246\220\321\217\125\345\267\016\324\116\220"
	"\027\137\342\025\324\246\344\352\062\131\041\062\357\373\211\350"
	"\374\220\167\172\367\275\234\036\317\355\104\344\012\225\023\216"
	"\264\314\155\105\100\315\140\323\063\167\356\354\111\113\315\124"
	"\377\263\232\136\030\003\051\273\125\142\055\342\002\357\266\030"
	"\053\046\130\151\131\004\362\054\071\024\020\337\101\247\326\030"
	"\135\334\106\227\374\122\165\235\253\311\164\151\017\156\222\053"
	"\033\365\175\057\351\314\335\005\100\033\261\313\152\206\136\044"
	"\132\303\020\210\276\224\211\212\176\035\341\301\066\065\207\067"
	"\010\234\034\136\114\321\126\122\142\111\164\064\113\243\310\375"
	"\217\110\213\041\377\015\272\023\263\133\146\245\126\204\300\314"
	"\251\331\215\223\171\336\350\372\241\042\264\330\111\241\035\234"
	"\064\126\165\014\101\056\160\244\374\372\336\201\013\310\176\203"
	"\175\250\243\067\276\203\305\001\052\122\103\114\143\121\005\302"
	"\034\060\205\276\246\210\123\175\232\013\155\223\110\001\265\233"
	"\341\326\332\041\255\312\262\326\331\207\061\021\150\211\062\251"
	"\055\033\067\011\010\223\241\046\334\133\140\124\075\212\074\325"
	"\006\275\037\175\106\064\204\067\362\310\252\365\075\376\344\012"
	"\376\041\122\063\106\177\054\221\346\165\031\007\207\264\027\257"
	"\202\334\311\344\206\166\346\112\264\133\165\306\315\150\271\177"
	"\313\040\035\240\060\074\100\252\252\263\113\056\210\114\207\377"
	"\131\336\347\054\206\055\117\104\100\360\021\164\367\130\334\264"
	"\240\302\235\137\114\005\067\251\061\362\052\014\260\141\032\203"
	"\237\126\336\210\204\154\373\175\020\366\024\030\326\354\152\104"
	"\130\205\005\076\020\007\225\341\035\240\230\162\250\041\044\140"
	"\137\334\111\250\142\364\127\347\342\112\040\007\356\342\175\216"
	"\041\230\000\213\142\107\020\105\137\052\317\121\147\330\261\245"
	"\300\262\100\127\300\262\252\343\250\026\153\353\003\253\101\210"
	"\172\223\241\334\332\262\042\072\334\362\213\103\313\074\350\213"
	"\357\051\343\257\333\216\222\204\245\376\157\250\252"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
