#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -f gc 
#endif

static  char data [] = 
#define      inlo_z	3
#define      inlo	((&data[0]))
	"\037\253\315"
#define      opts_z	1
#define      opts	((&data[3]))
	"\144"
#define      tst1_z	22
#define      tst1	((&data[4]))
	"\325\306\013\042\207\165\062\137\157\235\104\316\100\102\113\236"
	"\233\235\227\015\101\155"
#define      date_z	1
#define      date	((&data[26]))
	"\022"
#define      tst2_z	19
#define      tst2	((&data[29]))
	"\235\332\040\206\102\261\344\103\310\245\330\304\014\261\347\076"
	"\276\076\112\066\263\377\110"
#define      pswd_z	256
#define      pswd	((&data[51]))
	"\056\212\114\057\375\150\136\362\301\247\037\277\261\267\265\063"
	"\016\371\360\102\233\375\123\077\112\165\112\253\117\061\110\011"
	"\274\224\070\271\374\226\253\276\076\313\175\360\202\063\044\220"
	"\055\024\323\310\021\046\010\133\234\122\007\354\204\117\365\100"
	"\343\056\371\340\305\245\236\004\160\033\364\363\117\031\204\174"
	"\055\130\105\076\176\115\232\033\237\241\007\044\360\375\144\324"
	"\053\136\264\361\003\122\365\164\156\352\150\275\003\354\072\060"
	"\104\177\157\303\314\012\336\154\254\346\220\234\343\364\160\017"
	"\123\045\000\126\167\366\313\345\341\063\243\344\040\335\025\145"
	"\135\205\051\051\220\010\225\074\356\045\331\321\032\112\341\155"
	"\157\342\304\347\331\220\314\272\304\160\237\344\116\265\112\253"
	"\073\164\325\313\174\152\007\152\220\340\074\253\052\035\031\232"
	"\000\335\201\331\156\116\223\062\277\063\027\015\350\142\271\043"
	"\326\216\357\122\371\366\275\212\327\371\065\002\027\117\234\027"
	"\055\036\361\233\154\204\315\053\270\345\071\240\107\362\304\035"
	"\201\263\160\172\252\055\004\201\046\072\204\076\211\041\126\266"
	"\077\077\116\154\311\157\303\200\256\012\322\133\326\362\063\133"
	"\367\104\200\104\110\152\257\315\010\211\315\120\221\322\033\300"
	"\021\151\055\332\330\360\132\207\372\055\342\321\037\025\054\027"
	"\132\255\134\242"
#define      msg1_z	65
#define      msg1	((&data[358]))
	"\300\170\363\322\026\277\276\250\303\016\105\373\046\145\012\211"
	"\303\262\143\042\264\324\342\024\343\103\074\006\206\057\025\302"
	"\006\056\016\312\351\347\142\146\154\130\207\214\016\306\337\032"
	"\304\150\030\151\104\231\056\256\044\211\232\270\157\335\203\167"
	"\140\040\225\076\161\047\020\214"
#define      chk2_z	19
#define      chk2	((&data[430]))
	"\051\107\231\012\065\272\001\101\104\354\272\355\131\215\027\063"
	"\133\365\362\024\374\316\004"
#define      xecc_z	15
#define      xecc	((&data[454]))
	"\204\325\373\152\304\057\250\121\102\127\123\253\056\353\073\304"
	"\071\320\244"
#define      lsto_z	1
#define      lsto	((&data[472]))
	"\076"
#define      msg2_z	19
#define      msg2	((&data[476]))
	"\114\302\045\150\072\311\306\056\133\043\133\164\077\343\301\027"
	"\200\203\347\333\006\000"
#define      text_z	5503
#define      text	((&data[1716]))
	"\373\125\342\013\342\311\055\330\336\052\247\342\201\375\342\006"
	"\067\262\253\206\257\150\060\131\201\175\033\246\072\376\141\066"
	"\123\103\102\066\015\157\016\353\232\265\316\033\263\260\042\352"
	"\142\315\161\022\065\242\153\267\037\207\135\132\206\277\220\332"
	"\002\322\020\017\102\036\373\334\324\311\370\207\171\032\162\334"
	"\350\343\356\036\205\132\325\244\342\062\377\150\362\217\102\364"
	"\141\122\004\244\161\000\200\105\311\170\314\103\222\076\040\173"
	"\042\017\231\250\152\156\115\114\241\114\264\223\333\367\210\075"
	"\112\215\341\273\215\142\000\126\332\315\232\155\014\273\350\057"
	"\312\201\327\064\360\044\200\221\160\065\045\114\054\255\211\166"
	"\072\153\061\310\315\062\037\250\000\271\025\015\164\376\074\077"
	"\200\023\164\160\070\365\002\250\052\050\365\126\325\177\315\020"
	"\352\377\330\270\061\367\141\062\261\166\077\046\165\174\146\365"
	"\220\332\145\310\317\150\160\371\220\146\120\146\345\035\166\317"
	"\034\117\210\116\107\351\201\370\140\300\037\326\075\205\313\315"
	"\137\061\225\057\231\006\050\051\154\171\217\121\227\006\041\264"
	"\126\252\003\235\224\204\226\365\105\265\313\202\073\226\117\232"
	"\307\345\312\140\353\363\212\130\154\032\251\004\040\313\270\167"
	"\165\273\024\012\077\253\377\204\140\312\007\234\141\126\067\050"
	"\073\001\211\047\364\024\177\140\056\051\144\117\364\035\306\152"
	"\330\333\164\030\206\164\235\347\076\244\203\240\373\272\310\067"
	"\273\122\136\257\147\336\020\225\007\165\345\374\222\253\147\153"
	"\206\334\204\015\120\041\364\217\306\167\057\302\062\370\371\355"
	"\113\130\235\262\066\255\110\076\042\055\073\265\331\242\040\140"
	"\177\244\155\317\306\141\137\215\331\217\117\013\207\110\371\323"
	"\241\226\205\330\103\316\027\146\373\122\033\324\365\074\065\164"
	"\341\242\103\247\004\243\064\335\062\204\351\272\314\342\215\156"
	"\170\023\106\274\341\135\042\335\257\075\261\245\171\346\031\132"
	"\211\135\002\215\000\067\153\063\273\125\355\210\067\173\366\260"
	"\216\075\154\160\232\217\115\112\314\377\357\106\346\010\241\160"
	"\145\244\375\146\333\151\231\227\276\207\037\366\002\026\247\221"
	"\123\023\001\356\243\117\070\157\117\047\266\065\060\130\245\226"
	"\374\243\375\330\015\226\160\314\035\220\302\040\246\152\261\372"
	"\176\262\350\041\002\040\221\121\110\107\207\171\240\054\020\235"
	"\320\015\166\335\244\346\251\301\166\154\341\035\326\223\030\124"
	"\106\000\166\110\041\007\232\152\117\041\344\357\116\364\214\036"
	"\001\002\374\246\351\245\147\137\022\111\175\351\334\225\075\043"
	"\226\263\153\267\273\005\042\012\047\006\371\165\372\206\223\374"
	"\210\217\242\161\065\012\321\110\124\117\061\061\344\156\124\173"
	"\042\300\063\335\306\125\350\355\134\341\142\127\147\366\123\360"
	"\206\366\142\274\001\063\004\125\202\065\206\147\244\333\342\307"
	"\233\026\245\141\153\215\117\310\156\261\037\326\250\162\307\056"
	"\151\051\353\152\134\357\277\337\044\106\107\311\042\052\220\276"
	"\100\065\037\254\302\157\164\061\040\223\010\311\005\317\367\157"
	"\370\342\331\125\322\231\064\367\337\173\300\002\245\120\300\345"
	"\206\340\221\110\117\005\172\157\230\203\071\236\122\060\015\113"
	"\023\347\240\346\200\324\335\140\120\235\142\365\356\042\333\164"
	"\002\155\275\121\163\070\301\014\273\372\253\016\053\271\131\077"
	"\240\372\046\040\317\003\200\037\241\342\025\220\005\361\004\010"
	"\136\302\131\321\373\033\335\266\026\211\305\102\102\037\202\342"
	"\031\250\002\350\253\203\010\115\146\035\335\153\016\342\164\155"
	"\244\316\077\240\351\035\126\000\246\034\103\350\073\305\312\125"
	"\155\315\076\031\120\106\146\267\144\103\043\163\046\227\341\313"
	"\145\040\153\117\075\301\120\343\336\223\314\032\130\226\160\306"
	"\144\256\337\265\365\105\154\132\211\220\316\260\047\257\173\215"
	"\317\346\334\015\250\054\361\206\277\275\240\030\124\020\336\270"
	"\277\275\155\265\003\332\017\215\152\335\075\221\215\270\036\135"
	"\236\373\152\106\050\133\315\350\031\156\000\155\177\337\046\076"
	"\234\223\363\240\155\003\056\330\340\154\151\155\044\210\312\303"
	"\204\065\012\254\221\327\224\253\106\225\030\305\164\076\004\021"
	"\322\367\262\100\373\340\030\333\115\202\111\161\012\024\065\217"
	"\112\100\074\333\030\320\206\136\146\237\043\333\336\050\355\260"
	"\037\237\360\033\200\010\366\315\213\100\077\226\125\164\045\237"
	"\265\141\173\315\062\002\053\231\242\117\164\200\167\141\061\227"
	"\000\041\262\201\052\251\116\266\352\216\114\077\002\161\337\270"
	"\323\132\205\005\135\260\236\377\000\022\200\167\164\261\017\165"
	"\323\301\366\376\153\105\264\125\323\000\224\326\162\163\216\105"
	"\316\023\112\053\304\351\053\304\374\253\074\160\134\113\345\057"
	"\015\333\056\170\041\342\315\364\342\142\312\124\326\130\232\245"
	"\153\344\321\060\315\374\364\311\250\060\072\004\174\037\064\211"
	"\373\143\001\034\105\317\020\050\062\332\175\011\063\027\256\237"
	"\374\177\317\311\174\303\223\045\364\315\052\160\355\136\371\350"
	"\301\373\005\007\313\025\057\375\360\255\007\044\304\265\303\300"
	"\065\222\212\262\126\036\327\112\354\001\273\331\140\265\302\042"
	"\261\307\051\174\335\131\172\316\006\201\362\312\067\266\213\155"
	"\110\025\037\236\064\366\351\040\370\245\372\130\132\274\172\013"
	"\204\244\207\142\375\165\261\216\125\310\333\043\345\020\162\113"
	"\174\067\140\210\074\314\347\305\304\307\335\001\257\021\050\257"
	"\046\365\350\222\354\037\220\055\147\326\007\250\047\203\134\271"
	"\062\203\143\007\137\005\263\302\104\112\374\051\100\134\007\001"
	"\167\113\213\165\033\112\220\044\043\233\234\221\051\001\147\006"
	"\053\250\376\227\324\305\343\375\277\231\340\311\055\032\040\024"
	"\265\070\213\030\256\237\065\262\167\353\025\125\051\300\145\004"
	"\333\332\172\335\110\064\226\336\150\330\274\001\221\266\223\353"
	"\275\352\044\212\064\115\172\367\203\177\146\116\015\037\107\345"
	"\100\031\140\256\256\254\122\353\167\232\072\206\276\125\044\114"
	"\140\132\061\301\215\121\271\047\356\037\247\101\072\365\343\254"
	"\025\115\062\070\050\154\327\251\141\347\204\104\063\047\103\216"
	"\376\002\205\244\241\107\264\236\313\370\301\002\041\270\033\332"
	"\271\340\372\031\212\363\240\372\331\012\323\335\075\303\164\007"
	"\227\150\332\264\076\375\252\201\241\043\077\311\161\052\352\353"
	"\266\067\212\001\273\034\051\132\154\343\242\165\062\115\130\156"
	"\300\264\120\372\156\040\365\331\064\114\163\040\217\140\040\120"
	"\043\361\167\350\305\311\147\064\274\307\272\356\001\217\071\360"
	"\066\074\220\021\203\011\227\245\072\154\115\123\110\251\134\227"
	"\335\110\205\166\020\333\171\103\044\147\304\267\216\313\241\022"
	"\261\327\030\062\313\343\350\357\363\236\053\027\314\351\107\242"
	"\235\370\252\357\135\067\230\160\065\365\177\073\176\217\317\346"
	"\056\136\104\256\240\104\256\235\151\001\275\324\011\121\042\122"
	"\121\037\113\266\377\160\344\123\314\043\056\217\261\141\017\276"
	"\340\017\342\026\270\137\237\311\255\041\343\213\344\236\020\123"
	"\116\274\157\031\070\303\247\175\154\101\255\170\323\056\310\110"
	"\232\226\335\176\012\322\304\054\065\341\152\366\161\275\205\325"
	"\206\324\327\330\377\002\334\200\022\265\007\364\077\233\367\123"
	"\220\370\166\073\172\006\354\077\003\127\210\237\047\121\301\027"
	"\211\337\271\307\112\273\345\247\040\365\250\235\135\002\023\133"
	"\206\302\101\040\075\235\310\165\337\223\063\261\255\226\224\017"
	"\035\337\276\136\266\302\133\114\037\263\241\377\142\035\135\074"
	"\245\252\322\046\115\074\356\222\376\141\004\131\150\275\250\354"
	"\142\315\200\144\224\221\030\250\260\326\266\114\316\031\214\165"
	"\243\243\233\244\200\164\016\324\166\323\345\032\212\043\277\043"
	"\046\362\244\303\363\073\223\245\151\153\006\361\114\233\351\271"
	"\345\342\263\363\166\174\123\355\027\033\345\312\273\142\205\061"
	"\042\131\057\150\025\266\236\141\343\260\142\244\064\350\344\014"
	"\352\017\027\342\344\227\047\237\215\165\241\125\240\167\336\271"
	"\350\004\115\016\266\204\361\141\310\340\036\301\023\256\113\333"
	"\062\161\374\035\252\075\164\170\272\074\221\322\106\320\174\246"
	"\172\177\316\275\102\360\156\100\216\360\064\136\020\222\200\121"
	"\104\376\023\370\017\341\020\233\034\240\135\375\317\365\361\247"
	"\002\110\053\334\264\301\076\272\350\117\124\026\213\103\136\363"
	"\243\142\016\372\306\103\236\130\365\234\015\153\035\032\052\241"
	"\065\313\200\301\141\050\374\123\251\026\270\277\144\137\243\126"
	"\106\324\122\172\323\125\317\307\325\245\152\126\256\022\024\017"
	"\307\017\332\262\317\357\226\217\270\210\070\333\376\244\136\226"
	"\205\024\364\025\202\217\175\032\370\067\041\067\240\060\144\362"
	"\342\156\104\042\160\321\123\217\200\241\243\257\265\307\047\223"
	"\072\063\120\000\152\077\235\004\346\320\032\075\072\270\332\101"
	"\255\232\065\106\334\320\375\053\377\373\060\232\326\025\167\314"
	"\324\221\254\043\336\177\136\335\163\263\041\351\045\130\005\143"
	"\112\034\242\143\314\055\331\235\311\131\317\122\127\270\236\311"
	"\353\140\321\014\120\130\057\133\375\315\336\047\377\301\031\172"
	"\050\313\246\126\014\051\152\250\321\103\371\061\027\103\255\151"
	"\243\111\046\234\321\305\334\252\324\053\213\155\322\305\232\227"
	"\044\324\146\006\165\360\255\202\047\113\045\214\005\104\335\200"
	"\002\212\075\247\232\160\267\000\016\203\037\131\305\071\236\345"
	"\110\106\357\204\346\322\232\116\325\327\014\014\320\333\223\176"
	"\246\014\237\251\334\246\237\241\307\176\276\150\220\256\345\236"
	"\152\210\373\362\220\365\357\204\311\067\156\200\133\157\366\104"
	"\160\304\353\142\376\376\075\300\246\270\035\066\034\142\045\330"
	"\004\266\144\126\303\070\320\173\175\141\077\311\332\070\376\307"
	"\112\002\025\277\322\024\166\147\131\261\140\314\350\045\124\034"
	"\162\151\230\255\115\246\335\361\216\332\143\075\006\325\007\150"
	"\207\032\016\110\041\077\361\030\103\247\025\303\123\225\144\246"
	"\111\075\160\351\114\145\025\022\020\051\362\201\366\301\076\263"
	"\012\005\274\314\047\376\134\147\063\172\052\344\164\010\006\033"
	"\105\016\125\210\253\210\232\243\245\262\026\364\010\016\065\355"
	"\030\333\115\327\131\035\305\113\240\200\131\312\123\342\211\247"
	"\236\102\367\317\310\061\137\316\077\117\375\171\332\321\014\323"
	"\151\176\132\000\010\202\051\073\303\227\243\131\200\104\164\314"
	"\011\127\166\301\321\235\106\147\263\277\144\303\114\067\130\163"
	"\307\265\222\047\010\140\324\241\250\133\016\346\025\142\337\157"
	"\105\321\131\033\107\205\354\223\360\331\377\023\273\016\162\311"
	"\102\256\127\166\244\171\150\217\231\350\337\104\370\230\255\334"
	"\252\103\255\375\202\231\003\012\233\047\025\050\344\143\307\023"
	"\013\137\042\221\121\161\250\161\072\143\374\322\210\032\162\166"
	"\242\111\267\064\375\251\042\060\303\050\142\221\114\003\250\372"
	"\066\275\037\011\036\121\120\015\115\117\304\331\251\353\227\137"
	"\060\024\063\255\234\056\163\026\273\136\237\036\305\321\122\316"
	"\077\013\367\125\017\202\216\174\105\017\023\302\011\070\011\376"
	"\120\173\022\075\266\337\105\035\015\005\274\162\166\040\265\073"
	"\315\253\036\370\030\172\245\226\106\021\170\160\173\043\261\373"
	"\374\116\100\014\262\353\126\141\331\207\071\116\070\000\225\340"
	"\107\166\273\173\246\351\001\124\300\270\074\172\340\254\273\204"
	"\151\210\050\115\006\212\230\312\041\017\016\151\263\214\153\022"
	"\343\171\122\131\331\256\110\102\142\046\262\301\257\312\132\243"
	"\010\037\006\077\314\373\244\051\164\004\165\046\211\015\160\026"
	"\371\030\173\262\174\274\275\100\102\126\045\321\332\010\252\215"
	"\020\134\141\140\245\024\364\245\114\051\334\221\064\106\300\315"
	"\026\067\261\360\321\277\115\072\333\057\220\322\014\231\044\115"
	"\204\064\126\337\231\001\253\122\303\012\315\020\260\211\265\063"
	"\066\073\052\365\333\005\176\306\061\256\074\112\225\367\150\201"
	"\157\015\072\010\157\113\065\377\355\135\272\134\134\027\363\173"
	"\036\363\035\261\136\276\224\242\222\067\120\240\217\340\232\064"
	"\054\072\252\002\152\105\361\120\343\303\322\060\342\163\251\206"
	"\375\230\013\216\024\016\212\307\122\302\013\070\357\312\164\225"
	"\136\377\346\341\232\067\035\237\265\320\120\135\264\133\044\330"
	"\206\344\145\123\117\050\202\023\371\047\223\336\223\056\334\017"
	"\156\067\151\244\200\373\343\245\143\032\216\114\124\066\210\110"
	"\161\117\130\237\227\375\300\332\137\315\313\172\131\142\064\050"
	"\316\220\032\125\142\337\221\131\006\161\026\126\132\202\067\175"
	"\326\167\021\027\325\117\324\035\251\214\355\347\051\370\167\351"
	"\175\040\111\030\032\124\326\226\061\117\363\054\106\252\245\133"
	"\256\234\010\245\067\012\122\215\101\276\170\216\251\001\172\346"
	"\227\372\063\160\374\240\305\243\134\146\036\201\376\123\025\175"
	"\047\123\243\357\330\067\025\135\002\154\205\021\350\151\352\016"
	"\154\240\014\175\007\324\050\110\011\112\211\054\255\342\126\256"
	"\301\060\250\011\136\313\232\176\265\321\076\156\200\232\376\261"
	"\172\166\073\337\220\344\051\317\241\142\240\144\255\174\160\216"
	"\050\146\243\140\043\016\347\374\076\206\351\124\166\271\034\147"
	"\052\021\245\030\247\236\155\253\135\262\301\307\243\210\253\217"
	"\177\160\313\202\110\341\341\367\361\143\121\120\362\275\107\153"
	"\024\167\042\327\266\070\330\306\354\317\121\025\321\362\122\074"
	"\330\251\261\174\033\372\134\027\070\242\177\247\274\126\242\035"
	"\140\042\005\236\372\250\113\345\263\044\145\051\260\142\024\240"
	"\232\221\103\373\226\251\163\012\074\205\033\047\274\207\314\055"
	"\215\261\276\352\264\125\056\045\330\201\142\012\062\267\344\055"
	"\114\013\163\031\122\270\322\031\306\015\257\265\357\156\301\177"
	"\357\373\270\360\322\237\111\331\341\015\010\146\001\164\371\316"
	"\007\020\010\112\304\176\323\263\000\043\266\210\266\060\036\151"
	"\360\376\067\150\314\342\174\165\126\060\300\042\070\107\153\311"
	"\324\025\273\260\273\142\331\114\371\060\274\156\076\330\011\055"
	"\230\042\170\226\105\010\341\236\106\352\162\160\135\017\273\253"
	"\006\312\211\315\112\065\327\044\030\310\072\215\352\220\250\056"
	"\125\110\236\347\025\010\140\056\121\337\061\176\126\215\015\013"
	"\116\270\255\373\253\070\007\213\112\054\115\124\254\172\300\155"
	"\331\306\060\065\021\022\272\350\062\163\375\025\377\240\157\275"
	"\120\166\241\013\022\002\254\304\020\361\221\137\307\135\237\174"
	"\215\342\144\137\211\012\324\241\075\036\024\376\371\103\010\350"
	"\122\171\265\272\344\217\167\265\353\237\164\117\140\111\264\343"
	"\102\153\372\121\311\342\132\151\052\200\235\374\112\216\013\256"
	"\066\213\024\100\367\361\336\325\226\131\002\175\361\367\103\102"
	"\235\234\152\171\037\312\353\004\336\210\035\056\357\215\113\312"
	"\113\054\352\175\262\032\131\151\105\151\017\357\342\370\061\254"
	"\205\046\324\266\015\066\254\236\051\250\063\134\375\030\232\321"
	"\257\361\357\076\267\032\047\317\206\243\272\223\233\312\103\103"
	"\361\023\011\035\276\210\356\016\270\217\245\135\076\210\010\127"
	"\110\326\054\107\221\356\236\100\062\170\112\024\363\005\115\047"
	"\126\175\227\014\375\173\326\244\173\344\103\026\026\132\373\043"
	"\270\313\012\200\221\135\075\101\255\103\115\113\006\127\006\353"
	"\204\214\171\174\110\046\311\373\163\227\055\120\331\147\105\036"
	"\311\364\214\115\305\102\123\225\371\115\207\357\107\234\377\042"
	"\022\115\151\016\175\134\060\222\223\310\137\326\135\023\072\010"
	"\100\060\115\213\055\217\033\060\076\012\155\120\245\363\052\111"
	"\144\107\174\071\253\010\353\224\054\357\114\107\233\217\241\250"
	"\236\253\063\013\253\314\316\062\050\276\365\127\100\364\306\217"
	"\075\223\350\022\312\177\330\222\304\160\043\220\122\300\220\153"
	"\150\201\276\114\072\213\276\053\044\310\127\146\143\332\355\155"
	"\012\100\342\072\320\021\312\000\120\310\225\350\174\356\001\202"
	"\266\241\232\203\206\010\136\041\330\322\323\235\313\306\321\164"
	"\250\157\033\364\063\200\005\027\122\040\256\252\205\026\237\130"
	"\203\142\143\151\327\377\034\210\227\176\230\357\251\134\307\070"
	"\336\264\041\031\006\067\130\150\174\236\237\270\301\361\366\012"
	"\132\144\232\377\261\003\023\001\161\351\253\321\142\140\301\226"
	"\020\045\022\311\203\221\220\301\322\132\171\360\045\001\272\030"
	"\307\001\350\360\125\177\033\064\047\053\361\116\360\071\004\327"
	"\111\113\331\107\237\065\237\241\232\146\374\265\146\176\241\304"
	"\061\035\064\232\361\367\144\071\052\241\033\265\160\372\335\201"
	"\307\147\004\340\302\153\076\317\303\332\101\003\273\326\170\252"
	"\242\256\353\140\041\156\345\306\021\260\006\043\056\242\333\363"
	"\127\046\352\115\000\100\300\377\067\026\022\105\224\251\144\212"
	"\262\046\000\037\200\014\240\226\032\373\326\114\004\053\341\045"
	"\145\212\336\304\014\135\177\231\101\066\266\075\250\267\035\217"
	"\374\301\041\171\141\333\271\332\016\326\305\177\332\247\207\055"
	"\372\206\025\271\054\016\360\376\065\371\043\103\367\023\245\002"
	"\233\213\150\062\161\363\063\050\341\213\376\013\037\224\027\356"
	"\241\176\275\335\043\220\116\306\301\341\167\216\324\232\016\244"
	"\234\003\244\002\232\304\243\243\112\002\166\356\236\261\376\110"
	"\206\330\133\350\237\110\203\053\062\371\347\002\267\063\223\063"
	"\130\261\116\004\111\315\004\117\065\226\251\027\367\353\025\176"
	"\323\271\223\206\230\320\351\161\141\131\151\001\343\006\162\157"
	"\301\151\252\035\046\077\364\102\351\263\071\352\353\234\242\235"
	"\216\005\251\210\027\035\333\350\051\060\027\103\100\006\324\241"
	"\160\354\057\372\306\272\205\302\020\145\140\106\222\150\006\056"
	"\075\253\244\362\271\126\346\315\253\037\136\013\250\310\023\012"
	"\324\041\117\004\261\220\245\167\223\311\303\055\022\151\137\233"
	"\333\000\266\032\060\344\354\374\101\316\323\312\342\311\103\116"
	"\043\261\313\155\220\173\353\140\353\365\030\314\172\043\364\137"
	"\301\276\212\136\256\366\040\230\102\047\217\346\311\244\161\036"
	"\226\225\147\334\102\104\343\247\176\205\243\375\323\232\225\022"
	"\031\374\012\311\222\041\324\200\133\203\320\225\173\137\010\326"
	"\264\112\222\103\052\044\225\347\017\304\045\251\371\127\370\203"
	"\020\361\327\201\305\122\151\340\044\230\120\071\017\325\023\370"
	"\204\112\061\043\215\073\050\257\074\114\277\155\346\236\231\037"
	"\274\104\236\111\067\144\177\110\314\113\171\116\075\133\003\013"
	"\240\352\300\043\145\254\071\377\260\020\033\326\127\001\365\160"
	"\035\256\351\205\355\317\245\153\357\200\164\252\167\352\324\103"
	"\253\327\304\061\121\154\140\163\033\043\004\122\063\055\157\355"
	"\211\376\053\136\242\200\372\233\312\273\207\205\157\167\165\137"
	"\175\132\133\255\176\040\322\210\064\006\144\014\330\173\351\160"
	"\242\314\064\327\133\173\122\347\010\310\023\201\216\241\236\245"
	"\010\317\330\053\356\130\203\202\120\310\065\131\066\266\352\106"
	"\100\146\104\241\030\247\000\146\332\353\012\225\210\047\223\002"
	"\013\255\231\175\171\016\173\247\136\067\374\005\175\132\021\310"
	"\264\275\017\340\165\177\131\175\016\040\273\362\010\210\251\303"
	"\135\217\041\114\152\232\245\023\210\267\163\205\171\265\211\200"
	"\144\171\373\306\374\124\352\157\001\132\057\203\105\355\255\026"
	"\270\150\111\012\070\102\047\200\154\207\325\277\302\104\066\314"
	"\135\255\375\250\247\060\005\046\037\360\123\002\036\355\242\075"
	"\023\224\245\114\130\134\346\365\162\007\005\347\164\276\352\275"
	"\273\324\326\333\253\217\211\232\330\321\274\246\214\313\044\016"
	"\233\201\142\320\322\267\053\211\262\343\373\252\337\000\151\003"
	"\305\337\142\040\244\030\122\072\002\146\103\267\260\033\362\246"
	"\313\046\126\025\362\270\116\273\154\326\342\077\143\237\363\333"
	"\211\303\263\200\247\126\101\252\226\323\005\016\037\043\257\017"
	"\056\331\041\037\201\313\130\065\116\262\111\151\166\072\053\106"
	"\034\000\036\307\172\110\021\374\006\013\001\246\351\250\275\331"
	"\235\017\330\015\310\055\375\147\354\225\266\277\363\201\017\303"
	"\205\133\032\076\126\101\303\222\357\365\133\272\044\361\276\144"
	"\056\065\160\064\276\157\147\260\144\050\007\160\033\102\274\316"
	"\217\052\042\335\344\364\350\134\035\031\253\361\106\117\240\266"
	"\050\242\326\210\213\171\044\253\000\277\063\130\142\227\212\275"
	"\342\202\206\057\041\370\124\011\341\310\220\043\277\173\327\353"
	"\010\212\364\030\057\047\201\340\330\015\100\275\024\074\343\053"
	"\141\072\350\202\212\046\177\227\347\275\042\143\075\167\345\021"
	"\166\366\052\376\130\153\315\330\163\075\254\276\330\125\301\077"
	"\247\153\027\236\127\025\343\211\020\067\335\166\375\343\051\144"
	"\130\114\201\015\346\122\313\300\100\141\000\322\176\306\376\330"
	"\242\302\020\376\142\130\152\055\360\166\060\131\375\070\134\160"
	"\355\370\025\235\150\017\320\033\237\170\014\175\067\104\375\217"
	"\226\261\360\361\347\272\046\121\305\352\243\366\023\231\054\010"
	"\167\214\334\017\015\261\333\372\065\072\033\333\147\133\060\135"
	"\321\035\070\267\230\136\332\374\051\170\164\365\373\220\003\102"
	"\143\214\273\334\126\357\010\140\275\053\360\355\220\007\200\027"
	"\332\105\215\234\112\316\113\154\307\233\006\123\245\120\212\261"
	"\056\132\176\073\110\030\137\177\302\363\357\212\207\234\027\356"
	"\265\106\330\022\337\054\154\356\114\110\357\105\161\266\242\060"
	"\255\235\207\107\077\213\051\352\032\220\200\233\347\112\001\027"
	"\157\253\314\142\345\042\020\206\352\270\271\227\245\206\207\332"
	"\111\147\315\026\062\377\153\201\022\136\314\317\372\113\347\306"
	"\226\157\141\372\307\063\103\237\041\137\216\003\225\030\020\131"
	"\312\321\026\274\253\344\256\023\026\111\203\151\374\207\307\106"
	"\051\204\217\324\142\334\361\212\152\136\012\062\070\342\101\055"
	"\052\052\333\021\307\163\150\022\256\113\066\170\145\307\360\320"
	"\375\127\306\066\262\262\326\310\050\147\222\017\203\123\117\033"
	"\210\050\330\334\354\005\233\366\014\125\137\002\274\003\030\307"
	"\165\041\056\315\020\103\340\306\356\206\304\106\167\342\347\346"
	"\311\201\363\335\322\013\132\132\000\376\042\346\271\262\013\337"
	"\270\222\141\265\064\201\115\337\071\105\133\344\373\066\075\002"
	"\107\140\340\372\354\100\325\350\240\122\307\077\122\356\174\362"
	"\216\110\374\012\046\246\117\041\255\130\174\233\231\127\261\021"
	"\263\360\047\254\313\075\356\346\360\264\035\261\145\164\223\014"
	"\220\302\376\171\132\023\121\101\036\260\243\151\011\364\077\275"
	"\277\121\223\312\141\244\033\374\036\036\073\054\270\237\234\230"
	"\006\350\344\072\055\161\000\357\114\305\007\141\302\061\271\347"
	"\131\173\365\140\062\057\000\220\257\174\116\146\010\157\317\061"
	"\315\172\115\144\164\004\304\332\357\145\365\007\054\173\154\115"
	"\006\245\273\205\012\013\021\243\311\266\136\163\061\173\257\366"
	"\303\233\026\050\125\041\030\372\366\240\046\075\223\364\236\200"
	"\253\156\240\205\320\236\342\041\366\221\305\233\241\014\363\236"
	"\355\011\230\237\100\040\072\264\063\146\117\366\127\266\106\364"
	"\213\271\175\147\327\243\063\277\315\243\014\046\122\144\215\376"
	"\341\251\141\144\161\160\154\055\376\224\063\036\300\367\361\216"
	"\070\305\225\070\364\162\121\213\102\333\165\230\052\142\334\257"
	"\125\363\365\053\326\241\050\032\334\360\241\306\127\207\212\316"
	"\117\174\022\275\362\017\345\230\366\101\346\273\217\373\252\240"
	"\321\362\325\365\353\046\214\160\040\261\160\034\033\220\234\030"
	"\056\245\146\223\226\374\116\316\073\136\250\315\140\077\241\017"
	"\036\105\214\015\062\177\351\207\256\260\013\204\001\052\372\045"
	"\273\012\025\177\056\352\337\024\274\352\164\174\156\025\374\174"
	"\113\021\276\234\251\341\114\162\215\360\114\176\005\366\312\340"
	"\272\037\266\050\372\334\306\364\334\262\300\170\230\377\045\161"
	"\067\341\161\164\365\103\075\217\166\320\000\055\137\354\342\153"
	"\233\100\112\320\331\277\167\057\117\250\332\312\323\371\307\105"
	"\367\045\213\272\057\035\036\000\002\127\151\104\331\262\374\167"
	"\330\174\367\162\055\156\111\076\003\137\120\327\024\201\216\116"
	"\247\010\245\112\216\044\136\250\357\061\145\262\004\216\266\206"
	"\067\223\205\242\053\156\344\161\225\324\151\073\320\171\250\074"
	"\252\227\020\117\136\310\223\365\264\362\062\213\004\346\360\127"
	"\226\135\261\221\324\324\360\212\026\313\207\074\021\210\235\110"
	"\231\264\054\152\206\227\073\032\024\006\130\303\070\013\232\121"
	"\345\244\057\122\227\103\174\054\266\075\222\051\247\005\165\124"
	"\224\116\065\037\170\214\253\143\034\353\241\372\333\314\130\310"
	"\245\105\305\365\174\362\045\171\325\061\145\341\061\067\072\377"
	"\231\367\053\307\377\377\363\205\140\214\272\345\306\076\100\143"
	"\341\120\373\234\221\035\175\267\024\147\262\122\117\116\171\200"
	"\201\360\230\316\106\232\031\265\320\025\104\307\132\260\162\002"
	"\037\326\237\072\077\212\076\161\022\320\175\260\241\304\146\247"
	"\153\072\152\023\314\033\056\212\356\074\245\223\227\030\040\224"
	"\264\266\137\056\265\127\072\124\260\323\335\144\045\336\145\223"
	"\374\347\115\010\171\261\050\072\112\226\003\177\364\323\166\003"
	"\334\315\373\233\051\374\152\011\013\362\252\135\325\336\334\206"
	"\262\222\227\221\120\170\253\045\243\146\162\246\246\356\103\241"
	"\117\126\132\047\076\026\373\271\043\241\222\105\035\142\163\064"
	"\342\172\125\200\122\251\105\340\040\333\120\051\372\060\170\211"
	"\345\314\326\054\223\220\307\371\156\364\125\176\137\210\076\010"
	"\351\262\112\111\151\353\126\056\011\340\226\056\034\267\044\124"
	"\223\202\167\323\226\213\364\223\213\050\040\352\235\261\112\043"
	"\363\001\006\221\073\222\332\025\353\074\163\076\026\301\166\257"
	"\217\366\133\167\244\351\166\112\171\110\217\047\316\204\022\211"
	"\065\256\270\267\275\032\355\104\215\204\301\003\036\133\365\030"
	"\032\244\032\053\141\374\076\015\173\166\373\350\256\315\060\053"
	"\262\311\005\065\221\113\225\277\252\256\027\275\147\060\206\112"
	"\051\363\161\055\053\310\026\173\227\023\036\236\070\052\146\352"
	"\355\143\334\017\231\040\271\175\333\245\177\120\123\321\315\354"
	"\261\253\015\046\250\233\371\317\116\111\362\137\371\103\216\262"
	"\077\216\125\304\057\372\230\170\130\316\062\375\124\077\117\306"
	"\077\304\263\267\012\361\233\327\353\025\041\116\230\307\030\255"
	"\370\207\355\030\050\065\107\114\302\252\337\054\003\223\266\251"
	"\075\350\262\332\256\006\015\334\162\073\161\263\337\260\031\201"
	"\133\152\107\130\343\320\341\360\347\246\055\361\360\073\146\071"
	"\343\047\226\057\060\324\221\306\304\117\067\037\243\365\115\324"
	"\362\032\153\365\051\250\327\136\307\204\356\375\361\240\025\307"
	"\126\336\202\250\320\014\065\167\237\357\232\340\000\060\300\251"
	"\060\141\045\115\144\270\243\153\067\354\241\110\347\153\316\036"
	"\067\222\230\234\147\020\223\220\171\010\262\027\141\247\223\134"
	"\075\043\214\023\374\111\240\200\330\254\364\124\076\046\245\370"
	"\347\127\105\234\263\066\266\267\326\003\100\253\355\007\130\231"
	"\310\247\222\076\330\376\315\114\316\222\000\204\253\314\071\124"
	"\203\255\015\004\371\344\127\041\261\025\344\070\373\043\364\353"
	"\361\133\263\043\164\245\317\170\207\133\250\000\331\204\033\101"
	"\017\103\107\244\220\275\272\316\166\331\275\335\355\230\347\042"
	"\375\061\335\003\134\051\057\377\115\234\166\205\054\147\131\321"
	"\203\377\161\245\314\004\117\231\267\106\207\173\033\205\075\265"
	"\131\010\031\041\120\065\375\354\062\126\243\130\260\311\361\311"
	"\116\021\261\343\237\155\337\135\070\145\115\170\350\160\263\235"
	"\171\220\332\075\253\004\376\203\315\323\215\017\217\052\131\310"
	"\304\334\174\212\375\223\367\326\142\216\141\274\341\140\340\247"
	"\144\260\133\250\170\155\227\352\341\011\022\164\250\151\360\145"
	"\273\355\046\066\121\034\005\324\065\135\054\247\314\015\247\020"
	"\277\150\344\067\170\152\327\311\042\143\101\015\357\211\274\205"
	"\074\374\030\356\163\070\330\203\164\105\346\373\276\031\007\347"
	"\063\012\042\275\311\147\120\047\305\226\034\354\273\064\214\150"
	"\164\176\061\210\157\106\310\171\366\224\145\225\173\052\257\376"
	"\024\336\250\053\331\366\266\052\171\362\276\171\327\316\045\151"
	"\214\117\237\235\236\045\315\137\152\177\023\260\211\043\332\162"
	"\140\255\363\225\251\164\314\215\311\346\226\165\117\057\020\001"
	"\015\221\004\000\207\256\052\300\336\045\062\114\326\040\325\023"
	"\004\116\141\035\043\071\100\362\326\237\255\340\174\325\105\127"
	"\070\113\225\305\145\167\271\100\245\352\302\351\202\074\220\262"
	"\103\265\245\027\323\101\327\363\244\356\076\343\105\074\264\056"
	"\277\170\225\256\066\222\057\133\026\277\126\241\000\376\172\056"
	"\311\115\227\133\366\354\312\004\022\236\347\360\374\142\060\314"
	"\167\274\173\050\273\262\265\361\315\067\306\371\250\104\171\072"
	"\340\220\041\345\151\244\270\030\060\156\125\125\043\215\166\146"
	"\002\132\201\100\116\153\136\214\335\124\054\337\133\032\316\125"
	"\141\354\355\232\203\041\052\313\344\365\032\140\211\027\137\136"
	"\236\337\125\232\071\060\114\074\027\272\133\211\056\145\312\163"
	"\165\250\152\240\074\124\017\255\321\044\321\323\136\336\144\000"
	"\032\105\110\056\164\104\006\131\357\165\237\212\256\050\263\167"
	"\333\134\352\035\201\372\241\356\341\033\260\053\223\066\077\142"
	"\341\016\301\272\002\060\003\204\043\316\273\331\131\050\042\157"
	"\110\301\243\076\252\304\067\120\276\217\252\173\012\265\377\256"
	"\075\142\253\100\223\257\304\267\176\200\220\330\251\263\107\361"
	"\164\353\060\037\257\147\157\155\366\031\350\000\317\350\257\015"
	"\113\133\115\336\012\022\225\211\222\046\141\073\331\250\055\115"
	"\224\135\155\103\305\334\260\273\366\231\274\305\202\154\322\315"
	"\307\037\254\322\062\102\133\304\150\274\000\102\145\055\220\371"
	"\213\375\074\120\332\355\014\320\206\311\225\011\065\150\326\374"
	"\210\203\317\272\305\052\176\056\346\177\160\113\254\000\105\070"
	"\376\201\210\330\156\224\250\365\136\076\377\223\246\325\220\056"
	"\131\137\350\036\211\147\114\160\346\274\274\222\275\001\312\274"
	"\202\123\225\361\350\075\347\106\174\346\331\042\274\152\120\025"
	"\311\071\064\123\240\200\304\206\075\200\031\373\201\343\267\004"
	"\067\114\366\037\212\336\145\006\305\077\051\201\251\172\227\163"
	"\263\314\306\123\115\212\332\212\013\363\206\214\327\076\221\016"
	"\212\207\055\025\145\223\034\052\322\105\254\173\277\104\357\163"
	"\021\266\307\136\101\241\350\114\225\156\331\154\254\152\173\067"
	"\362\251\115\127\074\152\202\017\257\057\213\157\164\172\343\205"
	"\060\252\343\161\114\314\275\341\072\226\116\347\000\312\037\362"
	"\163\155\112\260\327\315\277\207\374\112\367\161\304\332\366\365"
	"\205\331\146\322\245\044\264\340\272\002\310\273\315\350\256\100"
	"\125\371\360\055\306\260\265\303\372\254\064\277\207\052\264\015"
	"\004\033\337\252\077\223\212\371\226\123\265\143\073\144\244\221"
	"\135\225\277\044\105\164\347\100\041\033\377\250\106\264\265\113"
	"\317\225\365\016\051\200\010\300\323\276\043\017\042\310\241\177"
	"\135\140\243\243\325\213\343\366\247\343\237\355\230\125\071\147"
	"\352\056\166\023\256\177\323\202\075\367\222\137\277\063\337\035"
	"\224\203\300\152\016\243\140\265\207\377\243\037\125\334\206\077"
	"\013\375\123\271\174\047\074\272\037\316\032\336\002\371\374\227"
	"\175\274\001\213\140\142\101\347\142\344\006\267\301\215\366\314"
	"\213\112\206\010\161\302\302\221\221\335\157\224\327\154\053\124"
	"\050\055\340\210\217\041\160\362\005\167\251\307\004\240\223\220"
	"\352\031\230\134\334\133\355\156\070\135\002\020\311\056\144\362"
	"\134\104\173\354\146\353\336\153\143\207\062\150\050\306\370\023"
	"\337\221\157\274\354\135\053\045\273\056\065\205\134\232\170\271"
	"\337\363\245\105\337\203\260\102\013\343\252\063\252\243\106\212"
	"\064\266\106\040\024\161\106\317\237\173\125\374\026\315\265\365"
	"\301\133\072\240\337\353\343\353\317\216\036\171\061\145\003\145"
	"\034\111\205\060\273\314\000\133\110\126\130\136\043\016\123\345"
	"\151\215\205\110\171\151\064\110\367\122\301\050\270\304\215\325"
	"\016\023\005\312\337\006\046\047\134\176\206\200\214\331\145\365"
	"\147\353\076\341\125\163\051\114\305\353\164\176\257\002\123\276"
	"\026\131\211\365\137\257\035\274\055\244\074\271\176\242\257\345"
	"\216\356\307\343\141\360\057\047\333\244\246\213\247\371\112\275"
	"\123\323\263\262\202\321\157\260\165\254\152\363\116\032\331\335"
	"\010\240\300\152\220\357\222\154\224\070\367\073\062\102\370\205"
	"\025\254\070\230\175\247\110\362\123\262\345\242\314\277\177\325"
	"\137\100\100\360\057\323\135\304\013\125\000\076\227\371\304\255"
	"\245\374\105\042\244\216\025\370\100\373\233\015\272\032\343\032"
	"\132\044\013\212\367\150\117\003\275\117\101\125\110\005\002\355"
	"\002\107\017\246\325\045\237\026\040\072\044\332\124\010\364\257"
	"\054\377\072\043\150\211\047\045\331\150\173\041\156\175\016\161"
	"\305\036\027\232\103\266\261\144\361\326\076\105\336\063\365\013"
	"\063\060\056\233\271\126\301\222\276\074\264\055\271\303\236\176"
	"\342\266\031\046\155\313\212\136\241\310\244\177\374\232\212\057"
	"\312\271\312\204\017\213\027\316\307\313\374\201\216\233\000\161"
	"\121\031\227\276\344\041\035\205\351\301\005\345\133\220\025\046"
	"\111\337\252\131\153\301\050\063\215\045\264\034\300\264\215\021"
	"\316\044\320\263\105\356\071\057\257\076\025\013\316\052\061\030"
	"\011\334\162\165\236\233\250\054\300\135\110\200\022\326\222\340"
	"\372\143\223\100\121\314\157\000\013\205\014\332\257\076\363\271"
	"\033\145\056\271\001\326\345\301\063\056\101\105\004\324\046\376"
	"\067\272\077\210\207\256\211\222\063\225\154\343\324\137\234\357"
#define      shll_z	10
#define      shll	((&data[8225]))
	"\306\241\162\140\155\062\016\047\174\155\324\220\217"
#define      chk1_z	22
#define      chk1	((&data[8240]))
	"\312\032\301\236\346\321\220\072\127\054\331\122\236\222\040\220"
	"\037\313\227\006\110\011\030\364\030\036\101\300\325\373"
#define      rlax_z	1
#define      rlax	((&data[8266]))
	"\220"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
